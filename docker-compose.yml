version: '3'

services:
  discovery-server:
    image: hashanchamikara/microservices-discovery-server
    ports:
      - "8001:8080"
    command: --logging.file=application.log
    deploy:
      resources:
        limits:
          memory: 128M

  config-server:
    image: hashanchamikara/microservices-config-server
    ports:
      - "8101:8080"
    command: --eureka.client.serviceUrl.defaultZone=http://discovery-server:8080/eureka/ --logging.file=application.log
    deploy:
      resources:
        limits:
          memory: 128M

  biz-application:
    image: hashanchamikara/microservices-biz-application
    ports:
      - "9001:8080"
    command: --eureka.client.serviceUrl.defaultZone=http://discovery-server:8080/eureka/ --logging.file=application.log
    volumes:
      - ~/h2-databases:/root/h2-databases
    deploy:
      resources:
        limits:
          memory: 128M

  admin-application:
    image: hashanchamikara/microservices-admin-application
    ports:
      - "9101:8080"
    command: --eureka.client.serviceUrl.defaultZone=http://discovery-server:8080/eureka/ --logging.file=application.log
    deploy:
      resources:
        limits:
          memory: 256M

  news-application:
    image: hashanchamikara/microservices-news-application
    ports:
      - "9201:8080"
    command: --eureka.client.serviceUrl.defaultZone=http://discovery-server:8080/eureka/ --logging.file=application.log
    deploy:
      resources:
        limits:
          memory: 128M

  website-application:
    image: hashanchamikara/microservices-website-application
    ports:
      - "9301:8080"
    command: --eureka.client.serviceUrl.defaultZone=http://discovery-server:8080/eureka/ --logging.file=application.log
    deploy:
      resources:
        limits:
          memory: 128M

  proxy-server:
    image: hashanchamikara/microservices-proxy-server
    ports:
      - "8080:8080"
    command: --eureka.client.serviceUrl.defaultZone=http://discovery-server:8080/eureka/ --logging.file=application.log
    deploy:
      resources:
        limits:
          memory: 128M

  monitor-application:
    image: hashanchamikara/microservices-monitor-application
    ports:
      - "8201:8201"
    command: --eureka.client.serviceUrl.defaultZone=http://discovery-server:8080/eureka/ --logging.file=application.log
    deploy:
      resources:
        limits:
          memory: 128M
